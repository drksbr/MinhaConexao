import{f as J,a as X,b as K,j as e,c as Q,d as Y,r as g,B as j,e as Z,T as o,G as ee}from"./index-CtE1KQDU.js";import{u as te,S as re}from"./useShare-C1K_nhpg.js";import{c as L,F as D,H as ne,I}from"./createLucideIcon-BNJws9G5.js";import{R as se}from"./refresh-ccw-BDIq8fHF.js";import{S as oe}from"./spacer-BGYh_yon.js";const A=J(function(a,f){const{borderLeftWidth:x,borderBottomWidth:S,borderTopWidth:w,borderRightWidth:C,borderWidth:z,borderStyle:T,borderColor:k,...F}=X("Divider",a),{className:M,orientation:b="horizontal",__css:R,...W}=K(a),B={vertical:{borderLeftWidth:x||C||z||"1px",height:"100%"},horizontal:{borderBottomWidth:S||w||z||"1px",width:"100%"}};return e.jsx(Q.hr,{ref:f,"aria-orientation":b,...W,__css:{...F,border:"0",borderColor:k,borderStyle:T,...B[b],...R},className:Y("chakra-divider",M)})});A.displayName="Divider";/**
 * @license lucide-react v0.451.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=L("RotateCw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]);/**
 * @license lucide-react v0.451.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=L("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),ce=U=>{const{baseUrls:a,testDuration:f=10,initialFileSize:x=262144,numberOfConnections:S=4,correctionCoefficient:w=1.04}=U,[C,z]=g.useState(null),[T,k]=g.useState(!1),[F,M]=g.useState({currentDownloadSpeed:0,currentUploadSpeed:0,progress:0}),b=g.useRef(0),R=g.useRef(0),W=g.useRef(0),B=g.useRef(0),V=g.useRef([]),P=g.useRef(0),v=(i,s)=>i*8/(s*1e6),$=()=>{const i=a[P.current];return P.current=(P.current+1)%a.length,i},_=async()=>{const s=[];for(let n=0;n<10;n++){const h=$(),d=performance.now();try{await fetch(`${h}/ping?n=${Math.random()}`,{method:"HEAD",cache:"no-store"});const t=performance.now()-d;s.push(t)}catch{s.push(performance.now()-d)}}const p=s.reduce((n,h)=>n+h,0)/s.length,y=s.reduce((n,h)=>n+Math.abs(h-p),0)/(s.length-1);return V.current=s,{ping:p,jitter:y}},E=async()=>{k(!0),z(null),M({currentDownloadSpeed:0,currentUploadSpeed:0,progress:0}),b.current=0,R.current=0;const{ping:i,jitter:s}=await _(),p=await N(),y=await O(),n=p*w,h=y*w;z({ping:i,jitter:s,downloadSpeed:n,uploadSpeed:h}),k(!1)},N=async()=>{const i=Array.from({length:S},()=>new AbortController);let s=x,p;return new Promise(y=>{let n=!0;W.current=performance.now();const h=()=>{const t=(performance.now()-W.current)/1e3,m=b.current,r=v(m,t)*w;if(M(u=>({...u,currentDownloadSpeed:r,progress:t/(f*2)*100})),t>=f){n=!1,i.forEach(c=>c.abort()),clearInterval(p);const u=v(m,f);y(u)}else requestAnimationFrame(h)},d=t=>{if(!n)return;const m=$();i[t]=new AbortController;const r=i[t].signal;fetch(`${m}/download?size=${Math.floor(s)}&n=${Math.random()}`,{signal:r,cache:"no-store"}).then(u=>{if(!u.body)return;const c=u.body.getReader(),l=()=>{n&&c.read().then(({done:q,value:H})=>{if(q){n&&d(t);return}const G=(H==null?void 0:H.length)??0;b.current+=G,l()}).catch(()=>{n&&d(t)})};l()}).catch(()=>{n&&d(t)})};for(let t=0;t<S;t++)d(t);p=window.setInterval(()=>{if(!n)return;const t=(performance.now()-W.current)/1e3,m=b.current,r=v(m,t);s=Math.min(Math.max(r*1e6/8,x),50*1024*1024)},1e3),h()})},O=async()=>{const i=Array(S).fill(0);let s=x,p=new Uint8Array(s).fill(0),y=new Blob([p]),n;return new Promise(h=>{let d=!0;B.current=performance.now();const t=()=>{const r=(performance.now()-B.current)/1e3,u=R.current,c=v(u,r)*w;if(M(l=>({...l,currentUploadSpeed:c,progress:50+r/(f*2)*100})),r>=f){d=!1,clearInterval(n);const l=v(u,f);h(l)}else requestAnimationFrame(t)},m=r=>{if(!d)return;const u=$(),c=new XMLHttpRequest;c.open("POST",`${u}/upload?n=${Math.random()}`,!0),c.setRequestHeader("Cache-Control","no-store"),c.upload.onprogress=l=>{if(l.lengthComputable){const q=l.loaded-i[r];i[r]=l.loaded,R.current+=q}},c.onload=()=>{d&&m(r)},c.onerror=()=>{d&&m(r)},c.send(y)};for(let r=0;r<S;r++)m(r);n=window.setInterval(()=>{if(!d)return;const r=(performance.now()-B.current)/1e3,u=R.current,c=v(u,r);s=Math.min(Math.max(c*1e6/8,x),50*1024*1024),p=new Uint8Array(Math.floor(s)).fill(0),y=new Blob([p]);for(let l=0;l<S;l++)i[l]=0},1e3),t()})};return{startTest:E,results:C,isTesting:T,realTimeData:F,downloadBytesTransferred:b,uploadBytesTransferred:R}},pe=()=>{const{startTest:U,results:a,isTesting:f,realTimeData:x,downloadBytesTransferred:S,uploadBytesTransferred:w}=ce({baseUrls:["https://mc-srv1.provedorveloz.com.br","https://mc-srv2.provedorveloz.com.br"],testDuration:10,numberOfConnections:8,correctionCoefficient:1.04}),{ref:C,share:z}=te(),T=()=>{U()};return e.jsxs(j,{bg:Z("white","gray.700"),borderRadius:"md",p:5,boxShadow:"md",position:"relative",_hover:{boxShadow:"xl",transform:"scale(1.02)"},transition:"0.3s",maxW:"full",minH:"400px",ref:C,children:[e.jsxs(D,{justifyContent:"space-between",alignItems:"center",mb:5,children:[e.jsx(ne,{size:"md",children:"Teste de Velocidade"}),e.jsxs(j,{alignContent:"end",children:[e.jsx(I,{"aria-label":"Share",icon:e.jsx(re,{size:18}),onClick:z,size:"sm",variant:"ghost"}),e.jsx(I,{"aria-label":"Refresh",icon:e.jsx(se,{size:18}),onClick:T,size:"sm",variant:"ghost"})]})]}),e.jsxs(D,{justify:"center",align:"center",direction:"row",children:[e.jsx(o,{fontSize:"9xl",fontWeight:"bold",children:f?Math.round(x.currentDownloadSpeed):a?Math.round(a.downloadSpeed):0}),e.jsxs(D,{direction:"column",ml:4,children:[e.jsx(o,{fontSize:"3xl",fontWeight:"medium",children:"Mbps"}),e.jsx(I,{"aria-label":"Repetir teste",icon:e.jsx(ae,{}),onClick:T,mt:2,rounded:"full",colorScheme:"green"})]})]}),e.jsxs(ee,{templateColumns:"repeat(2, 1fr)",gap:5,mt:4,children:[e.jsxs(j,{children:[e.jsx(o,{fontWeight:"bold",children:"Latência"}),e.jsx(A,{}),e.jsxs(D,{justify:"space-between",align:"center",children:[e.jsxs(j,{children:[e.jsx(o,{fontSize:"sm",fontWeight:"medium",children:"Ping"}),e.jsxs(o,{fontSize:"3xl",fontWeight:"bold",children:[a?Math.round(a.ping):0," ",e.jsx(o,{as:"span",fontSize:"sm",children:"ms"})]})]}),e.jsxs(j,{children:[e.jsx(o,{fontSize:"sm",fontWeight:"medium",children:"Jitter"}),e.jsxs(o,{fontSize:"3xl",fontWeight:"bold",children:[a?Math.round(a.jitter):0," ",e.jsx(o,{as:"span",fontSize:"sm",children:"ms"})]})]})]})]}),e.jsxs(j,{children:[e.jsx(o,{fontWeight:"bold",children:"Upload"}),e.jsx(A,{}),e.jsx(o,{fontSize:"sm",fontWeight:"medium",children:"Velocidade de Upload"}),e.jsxs(o,{fontSize:"3xl",fontWeight:"bold",children:[f?Math.round(x.currentUploadSpeed):a?Math.round(a.uploadSpeed):0," ",e.jsx(o,{as:"span",fontSize:"sm",children:"Mbps"})]})]})]}),e.jsx(A,{}),e.jsxs(D,{justify:"space-between",align:"center",mt:4,children:[e.jsx(I,{"aria-label":"Repetir teste",icon:e.jsx(ie,{}),onClick:()=>alert("Configurações")}),e.jsx(oe,{}),e.jsx(j,{mr:2,children:e.jsx(o,{fontWeight:"medium",fontSize:"md",children:"Uso de Dados:"})}),e.jsx(j,{mr:2,children:e.jsxs(o,{fontWeight:"medium",fontSize:"md",children:[((S.current||0)/(1024*1024)).toFixed(2),"MB"," ",e.jsx(o,{as:"span",fontSize:"md",children:"↓"})]})}),e.jsx(j,{children:e.jsxs(o,{fontWeight:"medium",fontSize:"md",children:[((w.current||0)/(1024*1024)).toFixed(2),"MB"," ",e.jsx(o,{as:"span",fontSize:"md",children:"↑"})]})})]})]})};export{pe as default};
